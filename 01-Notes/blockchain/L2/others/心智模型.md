
![image.png](https://raw.githubusercontent.com/dreamer-zq/PicGo/main/img/20240720202957.png)
加密货币的基石是数据库。它记录所有用户的账户余额、智能合约代码和状态。用户执行的任何操作最终都会通过执行交易并更新数据库来反映。

_“Web2”_数据库技术的问题在于，信任是使它发挥作用的关键。它依赖可信的第三方来维护和保护数据库。如果他们离线，那么对数据库的所有访问都将中断。如果他们在更新数据库时犯了一个错误，那么这个错误可能会无限期地被忽视。为了建立公众对数据库的信心，可以聘请审计员通过回顾性地检查数据库更新的有效性来证明其完整性（这是一项不简单的任务）。

用开放成员资格的参与者团体取代受信任的第三方的潜力是加密货币引领数据库技术范式转变的原因_（“Web3”）_。它允许任何愿意贡献资源的人读取、写入、审计并最终保护数据库的完整性和内容。该小组可以实时检查数据库的更新，这使他们能够立即拒绝错误并在事后很快发现错误。

开放会员团体对于范式转变至关重要，它可以分为两个角色：

- **提议者。**可以向数据库提出更新建议的代理。
- **验证者。**检查向数据库提出的更新的有效性的代理。

参与的思维模型类似于加密协议。一组参与方（提议者）想要证明某个陈述是真实的，而另一组参与方（验证者）必须在接受该陈述之前检查其真实性。这是一个交互过程，每次更新数据库时都会不断重复。

然而，如何实施开放成员资格小组提出了几个重要的问题：

- 提议者是谁？我怎样才能成为提议者？提议者人数需要多大？
- 验证者是谁？我需要注册吗？验证者人数需要多大？
- 我们如何才能达成一致意见并接受更新？

系统的架构以及数据库安全性的根本意义将回答上述问题。我们考虑了第 1 层和第 2 层系统，最终目标是帮助您建立良好的心理模型。

![image.png](https://raw.githubusercontent.com/dreamer-zq/PicGo/main/img/20240720203038.png)
在第一层系统中，可信的第三方被公众共识所取代。

目标是让所有参与者就数据库的更新达成一致。这需要一套共同的规则（“共识规则”），各方可以客观地应用这些规则。这些规则用于验证数据库更新的有效性。一个或多个提议者可以提出竞争性更新，但最终所有参与者都会就数据库的单一更新和数据库内容的单一事实达成一致。

公众共识的需要会影响参与度：

- **限速提议者。**成员资格需要开放，但仅限于对该系统的长期成功有经济激励的参与者。这是为了防止出现大量相互冲突的更新，并使各方难以最终达成单一更新。
- **最大化验证器数量。**更新的频率和大小将决定验证器的数量，因为它们必须拥有计算和带宽资源来实时验证所有更新。否则，它们就会落后，永远无法计算数据库的最新副本。

我们借此机会讨论如何限制谁可以成为提议者，数据库广泛复制的权衡，以及谁是唯一真正的区块链（和数据库）的最终决定者。

**限速提议者。**目标是找到有切身利益的提议者，他们的经济利益与网络的长期繁荣相一致。这是通过根据稀缺资源（从经济上来说获取成本高昂）的所有权来分配成为提议者的权利来实现的。例如，在工作量证明中，提议者必须拥有高效的硬件和具有成本效益的电力来源才能在采矿市场上竞争。在权益证明中，提议者必须拥有并将带内代币锁定在流程中。在这两种情况下，提出新更新的频率与所有其他参与者成正比。

**可负担性与可验证性。**网络的吞吐量取决于更新被所有参与者接受所需的时间。在拥堵期间，由于用户争相让自己的交易先于其他人被接受，因此网络吞吐量与交易的可负担性之间存在权衡。实际上，像比特币和以太坊这样的网络会最大限度地增加可以作为验证者参与的人，而像 Solana 这样的网络则以尽可能低的费用为目标。有趣的是，[ICP 的验证者必须获得批准并从某些供应商处购买硬件](https://www.dfinitycommunity.com/how-to-become-node-operators/)。

**经济多数。**大多数时候，我们可以将提议者和验证者视为保护数据库的集体。然而，最终目标是说服[经济多数](https://en.bitcoin.it/wiki/Economic_majority)，他们从使用角度来看有既得经济利益。在正常运行期间，提议者和验证者只是经济多数的代理，但如果网络的共识规则发生有争议的变化，那么最终将由全球大多数用户来判断由此产生的数据库的外部财务价值。例如，比特币与比特币现金、以太坊与以太坊经典的市值在社区对前进道路产生重大分歧后，显示出明显的赢家。

总而言之，第 1 层系统的思维模型是考虑一个数据库，该数据库最终负责决定资产的所有权，并需要经济多数来接受数据库的所有更新。这就是为什么从技术、社会和经济角度来看，去中心化对于第 1 层系统的成功至关重要。目标是尽可能广泛地复制数据库的副本，最大限度地让更多人参与保护数据库的过程，并最终依靠经济多数来决定其现实世界的价值。

## L2 的心智模型
![image.png](https://raw.githubusercontent.com/dreamer-zq/PicGo/main/img/20240720203116.png)
在第 2 层系统中，可信第三方被智能合约取代，有两个要素需要考虑：

- **桥接合约。**第 1 层系统上用于持有资产的智能合约。
- **链下数据库。**记录链下系统负债的数据库。

桥接器负责将资产从一个数据库（第 1 层系统）桥接到另一个数据库（第 2 层系统）。

桥梁合约的唯一职责是通过检查链下数据库的完整性来保护桥接资产。为了维护其完整性，桥梁在接受链下数据库的每个拟议更新（即，应用于第 2 层系统上的数据库的每个状态转换）之前都会检查其有效性。这对于确保桥梁合约持有的资产能够覆盖链下数据库中记录的负债至关重要，否则会导致大规模退出的情况。

维护桥梁合同的独立性可能会影响参与度：

- **任何人都可以提出建议。**桥梁应允许任何人强制纳入最终将在第 2 层系统的链下数据库中执行的交易。
- **单一验证者。**只有当桥合约确信对链下数据库的提议更新有效时，才允许发布资产，这才是最重要的。

我们考虑第 2 层系统的架构、信任假设如何演变以及使数据库公开可访问的目的。

**架构和中心化服务。**第 2 层系统的架构类似于中心化服务（如 Coinbase）。用户将代币存入第 1 层的桥接合约，存款反映在链下数据库中，大多数交易由链下数据库处理。这种方法在过去 12 年中帮助加密货币扩大了规模，因为大多数用户与中心化服务进行交互，并使用底层第 1 层系统作为互操作性解决方案将资金从一项服务转移到另一项服务。从历史上看，由运营商（如 Coinbase）来保护链下数据库并决定是否可以通过桥接合约处理提款。

**信任的演变。**多年来，我们目睹了桥梁联系人[改变了其信任假设](https://stonecoldpat.medium.com/a-note-on-bridges-layer-2-protocols-b01f8fc22324)，即它如何确信链下数据库的完整性是完整的。它已经从单一权威机构、多权威机构演变为外部区块链的共识协议。在所有情况下，桥梁合约都必须盲目地信任一组当事方的判断，然后才能将资产返还给用户。这导致了数十亿美元的盗窃，因为很难将一套保护数十亿美元的人工流程复制到数百个桥梁上。第 2 层系统的目标是完全消除对中介机构的信任，并允许桥梁独立验证对数据库的提议更新。

**数据库的可访问性。**只有桥接合约才能决定哪个数据库才是真正的数据库，并将资产返还给用户。使数据库公开可访问（即数据可用性问题）的愿望是为了保证第 2 层系统的活跃性。它假设会出现 1 个诚实的一方，他可以成为提议者，获取待处理交易的列表并提议对数据库进行更新。没有必要创建一个相当大的验证者网状网络来保护数据库*或依靠经济多数来决定哪个数据库应该具有外部现实世界的价值。

因此，第 2 层系统的思维模型是关于桥梁合约并支持其保护所持有资产的努力。无论大多数参与者的看法如何，它都拥有决定接受哪些数据库更新的唯一权力。同时，仍然需要参与者网络来确保第 2 层系统的活跃性并保证不断向智能合约提出更新。但是，这并不是依靠全球网状网络来保护数据库的完整性（安全属性）。

_*乐观汇总有一个警告，因为它假设有一个诚实的一方将协助桥接合约验证对链下数据库的更新，但最终真正重要的是桥接合约的最终决定。_

## 比较与结论

两个系统的架构和目标不同：

- **第一层系统。**目标是达成公众共识，并最终就数据库状态达成单一的全球性事实。
- **第 2 层系统。**目标是构建一个可以说服智能合约了解链下数据库的完整性（和状态）的系统。

这两个系统有着根本不同的信任假设。第 1 层系统必须依靠诚实的多数来保护数据库的完整性，并依靠经济多数来为数据库记录的资产赋予现实世界的价值。而在第 2 层系统中，不需要多数同意或外部评估资产。它已经可以假设存在一个具有公众共识的第 1 层系统，唯一的重点是保护智能合约持有的资产。因此，它可以依靠一个诚实的一方出现并确保系统继续取得进展。

在我看来，这就是为什么比较 L1 和 L2 就像比较苹果和橘子一样。这两个系统都有不同的信任假设、代理参与度以及最终的系统架构。我们的社区试图进行比较的唯一原因是，由于第 1 层系统的可扩展性瓶颈，第 2 层系统应运而生。我有一个改变这种叙述的软目标，因为第 2 层系统应该被视为桥梁的演变。它们应该与 Coinbase 等托管服务（保护 [所有加密资产的 10% 以上](https://cointelegraph.com/news/coinbase-custodies-11-of-entire-crypto-capitalization)）进行比较，因为这两个系统都负责保护链下数据库和一篮子资产。

最后，我希望本文能帮助您为 L1 和 L2 系统构建一个更好的系统架构和信任假设的思维模型。我希望第 2 层协议能够长期盛行，并证明其优于托管解决方案。这并不是因为用户关心系统的安全性，而是我相信运营商可以提供完全相同的服务，而无需承担保护数十亿美元的风险。因此，[托管（和信任）成为一种不必要且阻碍的责任。](https://vitalik.ca/general/2019/05/09/control_as_liability.html)
